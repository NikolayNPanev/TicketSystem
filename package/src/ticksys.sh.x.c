#if 0
	shc Version 4.0.3, Generic Shell Script Compiler
	GNU GPL Version 3 Md Jahidul Hamid <jahidulhamid@yahoo.com>

	shc -f ./src/ticksys.sh -o ./bin/ticket 
#endif

static  char data [] = 
#define      inlo_z	3
#define      inlo	((&data[0]))
	"\204\261\025"
#define      date_z	1
#define      date	((&data[3]))
	"\132"
#define      chk1_z	22
#define      chk1	((&data[7]))
	"\273\032\165\271\262\257\132\121\112\102\143\151\007\020\356\335"
	"\172\272\077\361\232\161\025\112\074\036\202\231\101"
#define      pswd_z	256
#define      pswd	((&data[49]))
	"\376\120\335\174\035\141\344\242\332\024\146\111\130\372\026\174"
	"\147\277\263\206\050\277\146\372\203\023\255\356\014\361\350\162"
	"\143\363\132\125\006\034\035\110\006\237\117\016\225\001\014\374"
	"\301\277\202\351\177\351\343\002\374\221\360\011\203\331\173\347"
	"\314\326\074\322\362\132\033\371\371\153\007\216\154\024\213\056"
	"\323\016\027\122\367\373\125\364\215\105\375\020\037\171\367\354"
	"\117\064\276\102\216\332\073\207\105\102\026\262\126\242\340\052"
	"\260\370\175\247\363\322\233\200\030\231\220\070\022\210\044\142"
	"\274\343\245\113\275\340\323\002\043\351\265\172\213\225\245\074"
	"\215\042\343\201\365\177\001\016\030\222\106\053\032\152\216\327"
	"\115\063\042\013\023\365\015\067\337\303\261\153\130\126\250\346"
	"\171\213\147\157\013\151\175\044\374\303\117\026\056\336\356\174"
	"\021\021\207\044\007\225\134\347\130\015\122\261\144\372\227\336"
	"\206\377\115\222\150\312\266\144\216\006\173\274\344\152\070\365"
	"\173\277\032\202\125\166\151\255\204\274\136\351\267\366\307\076"
	"\365\024\320\135\337\207\302\155\215\076\052\162\250\142\147\043"
	"\042\202\246\167\371\020\045\176\315\203\147\204\171\057\303\156"
	"\025\245\016\275\162\311\330\350\350\133\201\051\140\301\342\137"
	"\022\300\334\060\041\300\323\374\325\071\106\055\063\134\252\110"
	"\002\270\006\165\202\336\135\152\071\337\224\232\241\166"
#define      chk2_z	19
#define      chk2	((&data[354]))
	"\325\343\127\272\373\102\356\223\001\172\240\350\247\225\173\120"
	"\240\327\030\071\145\103\226"
#define      rlax_z	1
#define      rlax	((&data[374]))
	"\177"
#define      msg1_z	65
#define      msg1	((&data[385]))
	"\043\367\104\153\371\375\161\157\177\120\034\001\036\270\377\270"
	"\071\251\302\234\000\365\067\306\132\267\362\253\317\370\215\165"
	"\243\340\364\344\156\325\214\103\237\146\110\145\260\371\230\324"
	"\271\050\271\135\357\050\212\346\357\152\252\073\065\262\320\145"
	"\251\122\247\305\124\071\315\061\237\075\100\314\352\212\254\177"
	"\044\115\365\036\000"
#define      shll_z	10
#define      shll	((&data[462]))
	"\203\212\224\174\344\127\343\267\335\062\310\015\232\330"
#define      xecc_z	15
#define      xecc	((&data[476]))
	"\217\255\172\052\256\207\270\327\273\066\171\023\141\130\161\310"
	"\341\152"
#define      text_z	5567
#define      text	((&data[631]))
	"\321\213\323\121\333\237\074\146\114\273\212\231\260\251\231\334"
	"\234\175\140\047\030\070\035\243\253\255\121\025\201\153\171\123"
	"\366\114\244\322\354\341\070\070\234\303\321\115\154\153\052\011"
	"\351\212\060\002\303\116\245\156\373\366\204\175\141\375\320\130"
	"\112\165\052\066\126\143\157\363\047\100\100\223\254\152\235\225"
	"\365\316\227\270\034\075\047\027\064\253\224\226\251\145\356\363"
	"\332\031\052\061\174\231\044\243\332\144\067\206\317\324\034\304"
	"\243\264\175\277\361\244\326\045\120\153\273\371\320\252\354\252"
	"\303\027\334\077\260\000\343\212\145\032\020\336\150\271\205\012"
	"\266\347\037\063\372\310\124\341\074\024\323\134\316\335\146\177"
	"\012\056\101\204\201\314\251\176\335\235\071\201\243\236\105\204"
	"\212\252\050\021\105\245\063\134\346\202\277\266\201\170\064\123"
	"\360\200\024\311\211\124\373\161\105\024\031\077\276\022\022\357"
	"\061\221\331\065\132\061\145\332\350\105\127\303\211\041\030\367"
	"\015\206\233\226\052\164\157\123\264\122\011\036\332\326\226\226"
	"\306\174\001\133\230\156\241\270\045\156\233\346\137\062\237\116"
	"\057\066\340\353\131\322\112\216\255\207\141\041\253\316\037\105"
	"\217\011\114\250\170\265\104\046\002\066\015\122\062\170\026\023"
	"\055\217\245\343\360\175\141\071\112\326\231\315\047\240\106\155"
	"\155\064\207\313\125\042\034\011\316\355\014\213\305\140\044\045"
	"\256\071\121\152\050\140\131\266\306\016\036\334\037\056\006\356"
	"\263\372\343\045\250\040\175\162\021\316\320\007\052\252\155\007"
	"\052\323\107\156\140\211\316\232\334\217\367\150\113\246\103\247"
	"\250\314\334\222\065\204\166\364\210\152\137\156\021\070\251\250"
	"\071\063\073\304\312\152\126\376\050\227\210\106\330\165\130\111"
	"\046\205\353\037\007\044\330\031\330\257\012\171\125\062\240\150"
	"\155\133\052\173\260\032\126\172\156\371\310\307\117\131\121\072"
	"\114\162\167\060\206\047\216\122\057\017\147\226\344\115\312\043"
	"\205\261\010\062\360\244\225\307\235\230\015\223\032\160\130\201"
	"\306\116\015\144\265\242\303\265\043\253\050\100\062\264\035\176"
	"\315\030\010\250\331\336\152\157\246\213\207\120\242\156\061\366"
	"\255\124\071\347\350\236\371\143\264\323\367\307\065\260\230\024"
	"\321\165\027\233\065\372\064\265\117\245\374\251\103\003\000\217"
	"\171\004\261\225\233\010\052\162\004\317\345\205\245\144\164\234"
	"\361\077\126\217\004\017\155\255\153\304\334\010\326\004\255\111"
	"\337\037\003\075\113\300\353\245\042\017\332\135\132\066\335\170"
	"\074\263\062\225\027\364\150\175\243\267\021\227\373\332\133\212"
	"\061\172\111\070\051\071\216\373\052\224\045\177\177\262\327\066"
	"\133\175\010\051\052\100\117\200\022\114\337\250\135\213\046\106"
	"\117\273\050\123\347\354\377\137\071\141\326\051\244\060\155\247"
	"\235\317\101\075\245\237\000\124\256\106\316\320\163\274\131\217"
	"\320\037\212\375\314\006\071\167\002\263\131\213\300\153\302\372"
	"\276\004\016\341\152\221\313\125\277\006\272\327\346\223\010\002"
	"\232\256\165\111\005\011\271\100\213\327\103\346\224\204\002\152"
	"\170\114\106\263\216\012\342\220\352\371\175\061\356\007\320\311"
	"\372\224\304\333\206\133\153\033\213\125\202\064\311\114\214\152"
	"\356\067\326\076\217\345\375\354\047\142\067\036\303\315\124\365"
	"\174\256\076\264\140\202\352\323\206\204\047\215\160\047\020\154"
	"\172\074\045\344\033\345\271\074\202\237\377\252\170\373\047\310"
	"\314\102\124\355\037\005\133\046\023\203\046\035\353\141\310\173"
	"\125\300\002\334\073\131\217\134\237\173\171\204\233\230\067\306"
	"\331\350\170\357\023\262\056\276\310\200\061\317\001\127\223\141"
	"\350\144\337\153\025\376\272\304\127\125\033\152\252\340\204\356"
	"\245\164\062\074\345\057\372\254\237\355\226\075\325\310\274\273"
	"\204\025\077\354\047\010\212\062\341\262\004\003\224\121\342\316"
	"\042\006\257\204\301\344\212\324\325\216\177\134\063\135\304\344"
	"\276\000\311\136\343\145\315\231\253\104\303\267\301\165\120\210"
	"\222\070\142\257\024\137\237\050\220\340\301\222\151\115\163\074"
	"\153\071\175\252\330\350\312\074\260\332\115\207\266\104\173\152"
	"\050\075\316\047\303\154\367\164\010\006\141\370\116\057\224\206"
	"\136\325\150\111\047\116\002\356\070\324\140\212\323\353\330\172"
	"\010\126\067\315\246\247\132\250\053\326\247\240\247\163\033\151"
	"\331\146\156\072\345\011\043\270\051\051\161\255\127\277\155\112"
	"\277\076\360\160\171\035\070\017\302\307\047\153\371\363\115\354"
	"\272\072\115\351\010\126\026\127\170\112\074\251\134\064\232\244"
	"\231\254\307\340\272\247\116\051\216\365\332\056\021\366\075\025"
	"\027\114\120\023\225\141\315\352\145\135\340\050\113\105\364\062"
	"\207\044\021\005\143\144\366\110\174\370\274\077\172\146\357\370"
	"\353\334\001\137\165\041\034\200\360\206\012\101\273\022\111\336"
	"\103\367\054\255\325\031\056\205\045\127\314\140\060\020\212\367"
	"\346\042\346\355\120\365\014\011\275\231\207\323\062\111\206\025"
	"\337\253\136\177\316\222\100\153\371\274\270\230\027\063\357\247"
	"\037\347\153\117\160\376\114\040\167\031\224\373\245\247\067\005"
	"\153\120\156\207\160\014\372\103\250\330\352\057\240\176\347\146"
	"\277\273\266\076\327\235\307\324\066\222\020\345\371\242\152\216"
	"\062\325\165\203\171\150\310\276\013\336\376\327\132\375\263\014"
	"\002\247\047\122\271\032\065\267\245\164\042\373\323\275\152\067"
	"\245\016\125\173\247\171\037\000\123\341\217\156\146\212\342\323"
	"\150\331\311\021\376\101\152\052\273\202\314\344\344\274\314\151"
	"\316\375\253\032\242\174\155\130\203\161\313\304\162\036\134\165"
	"\114\005\341\340\021\167\130\221\251\272\226\360\333\052\017\146"
	"\313\124\066\332\013\123\134\362\063\136\164\134\267\073\002\006"
	"\256\120\202\153\123\374\226\026\020\377\147\337\141\143\314\021"
	"\253\344\150\150\202\214\107\011\117\135\303\146\230\002\320\376"
	"\354\145\116\331\205\145\273\046\024\146\223\314\242\041\315\271"
	"\036\355\261\205\216\160\262\315\254\224\116\210\227\337\120\356"
	"\112\311\340\276\124\206\023\201\320\122\343\272\011\123\257\352"
	"\313\324\250\255\356\364\374\242\357\100\225\243\044\077\277\205"
	"\221\223\135\243\132\222\060\321\304\107\376\110\030\354\366\217"
	"\152\347\013\042\151\061\140\170\301\363\350\014\004\331\307\335"
	"\333\027\226\060\154\014\116\117\024\133\231\376\300\052\171\217"
	"\350\205\130\263\225\321\216\205\301\330\134\254\351\272\114\326"
	"\372\313\357\247\160\332\052\106\313\317\306\131\123\353\106\165"
	"\163\303\212\236\037\225\001\021\207\271\163\331\311\170\224\374"
	"\350\130\240\023\102\114\110\167\033\165\264\322\014\375\053\345"
	"\354\261\243\135\242\222\066\331\376\073\330\353\064\163\230\013"
	"\373\265\030\123\326\041\275\054\255\224\372\057\274\351\347\242"
	"\246\140\225\351\105\265\242\064\047\277\061\323\355\213\344\272"
	"\033\002\146\071\134\162\011\353\077\062\312\106\257\200\226\131"
	"\211\353\272\203\063\365\234\372\172\064\027\276\201\040\124\123"
	"\334\115\327\363\235\243\022\371\113\164\245\364\202\141\345\126"
	"\057\070\037\313\000\265\220\366\171\252\047\257\077\160\055\265"
	"\047\144\377\016\101\063\066\122\042\137\331\062\177\204\170\012"
	"\337\265\344\215\050\214\120\173\075\217\342\212\353\232\203\345"
	"\004\236\300\266\012\121\067\016\252\320\110\035\371\107\323\363"
	"\215\241\232\373\273\125\252\136\010\361\175\300\276\136\143\076"
	"\216\023\076\060\130\020\025\001\170\176\245\020\134\003\211\252"
	"\156\111\071\232\167\354\220\226\363\357\362\122\050\341\074\003"
	"\320\345\015\175\301\074\106\221\301\006\023\075\351\313\132\372"
	"\007\123\305\151\075\053\256\334\164\177\164\322\354\302\252\171"
	"\224\004\120\012\215\336\217\022\055\064\335\107\206\356\260\232"
	"\013\277\115\055\306\137\101\377\163\061\054\120\035\022\236\025"
	"\131\030\041\004\144\274\254\354\261\124\171\056\162\370\161\052"
	"\271\310\062\054\210\276\234\371\136\103\167\132\166\216\333\236"
	"\173\217\246\315\143\135\165\223\013\162\237\142\252\100\263\224"
	"\026\205\256\346\210\341\134\173\142\216\042\101\064\032\124\206"
	"\051\051\374\246\242\072\132\107\275\050\341\106\227\302\252\313"
	"\257\241\163\175\140\064\162\355\027\210\273\205\374\260\021\330"
	"\305\045\045\073\010\323\123\200\317\274\217\373\321\047\173\037"
	"\122\041\223\201\167\001\147\354\012\157\237\037\137\325\146\065"
	"\330\351\261\060\323\010\120\141\103\232\337\335\317\207\251\023"
	"\373\326\371\100\167\052\021\320\043\244\121\121\210\062\155\034"
	"\115\260\041\057\153\311\220\371\271\164\163\162\177\222\121\353"
	"\172\177\376\143\062\133\322\115\105\120\204\356\172\276\162\253"
	"\005\150\102\042\064\067\262\172\010\002\302\016\365\247\013\254"
	"\141\075\054\174\177\326\366\042\013\060\242\332\021\122\375\271"
	"\340\021\147\124\210\016\253\032\151\001\124\315\167\172\166\113"
	"\205\041\066\251\300\000\346\015\276\056\030\002\125\000\160\024"
	"\212\305\221\104\226\062\231\161\252\126\122\322\341\217\307\016"
	"\113\073\033\153\302\365\010\261\266\156\135\201\352\121\374\016"
	"\223\064\212\314\047\160\367\213\356\046\153\021\364\045\350\211"
	"\366\260\317\237\276\072\133\100\204\323\245\121\255\167\253\033"
	"\364\221\256\201\356\210\104\165\053\273\253\161\054\055\306\071"
	"\033\213\302\012\271\230\270\032\276\375\372\207\277\142\026\176"
	"\003\176\020\113\060\101\064\151\045\156\261\270\143\260\033\211"
	"\371\230\153\354\373\033\254\143\340\265\000\160\345\253\262\303"
	"\370\325\315\036\207\306\046\205\100\325\240\161\235\066\173\270"
	"\133\367\017\334\220\352\167\125\376\204\243\111\040\023\075\340"
	"\343\056\260\327\066\101\303\054\155\236\143\062\121\036\320\066"
	"\151\137\010\372\127\351\074\023\242\324\147\135\053\324\145\261"
	"\032\345\321\015\117\257\140\344\262\165\247\025\253\013\312\025"
	"\370\037\171\347\124\216\204\134\072\113\072\354\246\035\300\103"
	"\165\305\020\173\354\016\330\171\256\035\261\230\377\075\247\047"
	"\110\133\142\237\331\211\274\022\037\156\340\043\375\230\174\143"
	"\326\044\066\014\222\170\242\344\275\200\325\273\227\000\373\066"
	"\311\036\076\035\113\100\137\323\160\213\135\113\233\106\200\230"
	"\205\171\362\306\264\224\152\001\122\344\130\043\257\256\230\326"
	"\305\267\315\135\162\260\032\331\253\355\265\175\364\100\161\357"
	"\232\363\027\004\025\013\030\102\006\242\173\074\211\044\030\114"
	"\236\203\020\270\166\031\052\326\231\153\300\032\146\145\315\063"
	"\375\000\156\200\174\172\237\153\364\050\252\050\012\257\350\150"
	"\045\041\100\344\160\232\046\263\242\165\071\265\152\131\016\240"
	"\125\276\247\245\327\354\374\303\010\166\035\263\262\332\021\310"
	"\075\056\112\302\136\262\110\045\020\020\132\030\024\044\036\302"
	"\265\150\343\143\000\136\036\225\071\020\317\022\343\247\300\063"
	"\147\321\202\177\133\356\333\167\342\277\225\254\227\167\361\051"
	"\215\024\141\010\201\147\172\165\156\234\256\220\105\337\251\175"
	"\375\023\253\353\212\026\030\256\263\011\322\217\322\003\153\102"
	"\152\164\023\363\222\157\104\244\054\011\016\212\313\313\325\202"
	"\215\143\200\054\233\240\006\257\255\041\130\246\322\235\154\122"
	"\246\241\021\005\376\130\242\001\142\154\032\156\101\025\351\131"
	"\204\221\025\127\260\161\063\224\050\305\144\235\263\015\220\055"
	"\233\175\327\151\335\367\157\172\032\023\043\303\055\300\035\330"
	"\000\222\134\360\334\250\157\310\376\332\327\165\070\240\207\041"
	"\315\027\250\042\373\260\142\364\203\006\204\162\347\070\013\142"
	"\222\002\314\305\207\316\100\067\237\146\142\250\253\107\345\100"
	"\050\155\103\243\256\235\265\250\156\051\240\215\353\264\206\213"
	"\072\334\211\346\374\271\027\353\204\072\037\215\242\123\077\035"
	"\254\276\366\247\151\343\057\047\350\374\263\235\022\373\353\060"
	"\341\062\235\347\167\066\170\240\260\064\252\213\076\102\154\055"
	"\154\262\114\162\247\101\370\265\342\166\357\323\107\123\037\224"
	"\040\351\006\170\100\171\074\366\071\212\223\312\124\247\275\042"
	"\346\163\233\377\175\210\165\307\204\136\101\323\041\331\114\074"
	"\237\212\047\070\236\310\206\303\057\260\035\356\300\106\250\364"
	"\073\154\224\105\227\355\235\107\272\171\000\364\273\347\141\213"
	"\053\027\237\166\040\220\141\231\044\067\247\151\052\172\164\240"
	"\166\334\237\135\223\026\125\171\054\350\334\275\366\121\252\271"
	"\241\204\371\373\022\161\053\304\057\157\124\033\274\325\027\264"
	"\044\175\146\302\207\212\122\007\141\135\216\306\134\031\217\226"
	"\164\217\071\331\132\312\177\154\104\316\053\125\110\303\112\342"
	"\111\106\207\204\202\012\167\200\325\057\104\051\172\307\060\126"
	"\123\062\032\300\023\147\016\145\332\262\076\273\106\105\305\143"
	"\235\165\021\227\325\325\057\372\217\331\340\056\176\303\046\101"
	"\033\222\254\362\167\253\357\245\052\160\267\224\134\226\054\315"
	"\334\011\234\360\200\027\312\360\166\360\132\026\135\006\210\060"
	"\370\307\243\164\220\310\331\226\301\037\206\012\236\304\257\066"
	"\002\073\300\053\040\052\321\100\235\026\201\070\046\141\013\032"
	"\265\112\137\350\326\115\111\171\214\301\150\211\342\305\045\342"
	"\135\263\143\312\275\177\025\233\142\152\155\264\033\116\115\022"
	"\157\111\173\142\152\277\050\012\170\000\274\333\305\216\245\024"
	"\043\021\176\302\342\025\257\300\336\210\010\055\341\257\012\325"
	"\234\175\212\330\327\205\254\377\064\025\232\050\137\233\012\274"
	"\333\253\101\013\155\234\102\042\052\240\255\153\233\237\030\312"
	"\252\065\024\307\325\233\277\052\355\117\014\145\000\026\057\310"
	"\215\350\164\174\167\103\167\352\347\266\047\152\105\042\263\362"
	"\357\364\213\036\203\314\306\207\060\037\305\351\242\102\300\027"
	"\157\070\126\211\036\232\102\106\270\106\123\010\047\002\172\363"
	"\131\034\063\206\311\170\123\347\272\154\170\343\115\304\042\161"
	"\246\230\163\163\225\104\232\352\143\371\334\223\333\225\134\247"
	"\115\300\351\146\342\367\134\335\333\305\160\164\213\347\235\326"
	"\163\263\227\125\260\242\275\060\057\176\126\274\155\257\142\117"
	"\243\351\274\064\264\030\340\053\164\125\306\124\326\362\154\340"
	"\342\263\300\056\243\002\070\046\163\276\267\146\000\200\335\325"
	"\243\236\210\327\210\223\130\140\203\340\054\156\366\177\000\016"
	"\003\311\174\141\010\374\206\330\353\072\161\202\355\052\305\177"
	"\171\017\026\155\024\232\044\267\060\321\306\160\130\131\044\303"
	"\113\144\226\103\223\010\144\302\300\123\030\155\002\021\152\117"
	"\260\060\356\123\273\261\063\221\020\202\146\207\244\247\157\140"
	"\332\151\305\241\371\137\152\014\127\324\007\263\002\076\327\306"
	"\314\015\332\054\326\207\167\221\346\277\035\047\067\075\030\246"
	"\177\102\265\344\110\001\352\002\225\300\204\130\307\164\317\056"
	"\112\100\324\366\260\111\250\347\362\234\272\132\134\150\362\362"
	"\324\225\072\076\265\373\100\340\061\143\202\273\305\177\243\157"
	"\356\371\067\203\116\236\006\321\101\044\105\115\304\353\173\376"
	"\367\250\222\124\211\127\212\166\211\004\313\135\120\314\224\175"
	"\361\000\344\371\232\231\322\060\023\270\036\233\173\242\045\215"
	"\200\146\103\044\037\017\116\111\013\063\214\350\376\203\371\200"
	"\356\025\102\307\276\127\000\122\060\165\373\164\230\266\147\166"
	"\302\364\071\034\014\145\341\326\324\205\337\370\133\257\237\173"
	"\204\170\151\251\077\201\115\101\140\155\246\012\273\176\244\011"
	"\304\006\224\231\213\050\033\171\172\167\156\162\212\044\324\235"
	"\054\034\021\035\012\373\261\021\234\222\230\055\002\262\374\272"
	"\174\307\167\001\110\056\342\212\166\205\255\077\366\033\131\023"
	"\037\276\147\207\025\321\255\172\300\337\375\113\060\110\317\347"
	"\257\013\252\153\260\203\313\277\310\323\244\340\043\355\244\204"
	"\306\347\046\253\227\110\261\104\121\007\061\114\066\216\111\224"
	"\327\020\343\163\245\210\137\374\371\013\123\150\026\166\072\135"
	"\356\375\375\004\367\335\164\307\002\345\014\341\245\060\313\205"
	"\230\053\156\333\322\074\174\303\062\160\155\375\346\212\266\247"
	"\211\140\110\073\307\366\104\132\012\363\047\350\253\002\066\132"
	"\324\177\175\256\040\270\205\322\220\334\005\367\031\354\366\067"
	"\021\246\105\021\045\131\030\140\234\222\160\340\343\226\156\367"
	"\127\374\355\100\235\073\207\356\065\372\076\200\210\233\271\202"
	"\335\175\175\243\160\276\002\207\372\321\133\261\200\367\112\047"
	"\123\322\346\275\072\370\100\130\141\274\236\303\365\341\250\046"
	"\265\115\344\311\255\164\172\336\311\142\362\317\050\315\236\145"
	"\233\226\267\117\153\163\353\216\317\111\221\273\257\373\026\115"
	"\062\147\035\161\263\270\355\174\265\133\271\030\233\116\270\003"
	"\342\260\230\260\175\043\312\302\175\370\372\211\000\244\222\150"
	"\175\370\370\045\377\236\337\073\055\334\146\351\271\203\243\137"
	"\107\213\372\167\003\210\221\251\075\076\253\164\015\163\013\054"
	"\173\205\256\013\171\354\033\345\151\375\310\001\140\161\347\246"
	"\104\316\257\301\104\111\137\246\330\230\267\346\145\015\310\121"
	"\117\216\376\350\023\151\023\313\047\251\131\066\326\120\306\040"
	"\362\025\131\373\132\371\152\311\076\066\222\112\123\277\317\121"
	"\217\104\067\162\210\320\063\250\245\162\212\000\366\142\220\072"
	"\362\104\353\213\025\020\167\146\236\111\201\235\041\345\031\031"
	"\144\216\205\252\153\160\016\116\202\337\072\105\024\117\073\023"
	"\346\154\106\172\376\244\255\077\165\323\104\245\046\214\272\123"
	"\152\314\217\326\372\034\061\106\375\316\341\162\312\314\254\061"
	"\243\340\142\144\304\214\032\310\311\200\141\321\353\160\312\243"
	"\220\177\356\227\233\331\201\220\332\217\060\025\102\165\154\071"
	"\204\146\114\311\375\065\132\072\306\070\205\132\110\140\135\142"
	"\306\225\150\327\021\032\023\212\077\330\011\170\121\210\326\374"
	"\043\055\143\054\323\265\173\052\111\025\255\042\274\154\335\321"
	"\074\065\271\170\173\310\117\241\313\124\174\012\363\300\354\146"
	"\377\115\303\103\116\003\004\142\263\071\104\076\224\234\227\125"
	"\113\304\000\134\302\223\104\266\240\276\361\206\101\315\073\206"
	"\045\107\175\223\217\170\160\207\336\046\073\124\156\206\033\321"
	"\120\064\136\046\230\205\233\021\333\023\232\144\005\034\102\277"
	"\175\325\142\361\143\254\220\147\142\175\005\166\356\247\373\037"
	"\110\205\106\374\324\252\171\000\000\266\036\217\150\305\316\246"
	"\247\071\271\306\354\247\117\052\135\070\354\137\243\112\142\264"
	"\177\257\113\126\001\376\273\231\202\205\370\271\036\017\035\100"
	"\370\060\272\321\176\057\036\325\010\226\035\215\124\204\203\017"
	"\123\054\303\065\346\172\067\122\306\103\153\362\243\132\227\120"
	"\164\071\306\365\223\101\100\056\103\345\372\137\053\247\350\020"
	"\332\122\373\034\204\126\272\201\134\225\222\053\160\313\273\270"
	"\150\252\261\041\025\044\163\042\066\274\372\247\155\356\232\067"
	"\332\160\250\047\142\012\164\024\326\135\116\020\045\160\032\013"
	"\144\242\262\232\126\123\204\300\257\052\051\262\376\074\020\074"
	"\164\123\342\373\154\065\110\010\013\030\335\013\364\177\201\037"
	"\321\223\047\020\007\003\164\161\027\154\025\377\261\274\172\043"
	"\332\210\356\033\012\211\164\221\244\316\006\346\124\026\200\331"
	"\137\066\302\310\002\063\066\055\257\037\217\025\347\065\134\262"
	"\163\004\141\327\233\142\002\350\347\350\123\134\001\153\041\044"
	"\252\106\305\303\304\236\170\102\152\152\116\137\056\003\105\061"
	"\007\260\271\222\262\032\321\200\137\353\354\173\266\074\073\045"
	"\014\170\322\235\327\135\017\251\223\341\216\237\252\333\230\327"
	"\062\153\177\311\235\175\040\315\117\273\250\031\115\163\013\213"
	"\357\065\260\217\232\177\146\334\113\305\212\131\365\160\036\364"
	"\340\272\105\111\266\225\266\202\204\365\134\011\026\042\233\356"
	"\064\030\226\353\260\236\366\015\114\146\074\323\141\156\220\331"
	"\344\007\067\125\326\142\373\322\256\303\175\030\323\015\246\037"
	"\211\273\241\114\143\010\271\275\367\234\371\111\251\162\120\110"
	"\257\132\363\316\235\020\137\264\251\263\146\323\150\073\333\022"
	"\114\125\275\355\036\350\206\146\137\321\054\016\232\177\162\355"
	"\011\361\360\211\221\203\273\100\204\217\160\232\140\104\344\231"
	"\200\116\156\001\162\276\231\350\167\272\360\231\060\202\350\011"
	"\262\210\352\076\165\013\073\100\030\051\115\316\260\373\223\112"
	"\137\026\351\261\200\120\020\211\064\230\042\165\373\012\106\261"
	"\117\001\244\236\211\115\071\315\104\315\215\345\073\343\003\015"
	"\344\373\323\274\316\251\276\017\222\244\063\313\355\205\101\053"
	"\251\267\125\061\036\101\075\206\316\346\171\043\126\321\066\212"
	"\071\122\351\250\274\357\034\371\173\300\134\105\106\313\052\325"
	"\305\370\333\261\311\263\376\321\072\230\371\170\364\024\224\147"
	"\046\344\333\014\070\072\270\316\346\371\165\116\237\356\310\111"
	"\147\351\171\204\036\302\233\076\352\355\127\260\203\201\147\110"
	"\364\374\057\155\202\301\224\212\156\122\057\344\350\056\305\052"
	"\004\271\166\103\055\257\165\077\323\367\054\152\361\315\227\234"
	"\257\164\113\364\314\072\362\323\144\305\014\041\247\205\365\131"
	"\245\276\337\377\341\341\175\370\221\373\125\050\347\052\266\350"
	"\366\365\012\227\010\264\107\022\356\041\317\031\362\303\065\104"
	"\370\040\234\160\306\110\303\265\047\354\033\015\146\176\055\272"
	"\342\266\117\244\175\227\144\371\101\107\351\307\253\310\340\314"
	"\122\124\113\242\151\101\044\326\327\232\015\335\116\256\172\150"
	"\372\245\147\017\235\271\362\305\326\316\123\210\153\017\040\071"
	"\234\214\330\227\156\224\173\042\034\317\231\127\031\224\206\377"
	"\002\214\070\037\237\306\306\200\317\152\074\372\061\151\233\253"
	"\256\146\046\320\124\120\271\276\010\204\033\064\042\204\005\267"
	"\236\103\110\045\070\074\232\226\165\327\357\321\235\102\235\166"
	"\227\043\024\034\122\171\137\176\315\323\235\033\274\104\220\066"
	"\024\146\367\265\171\144\305\264\047\245\306\366\344\251\033\044"
	"\325\244\351\000\351\257\344\245\135\365\334\020\202\203\225\141"
	"\374\003\114\056\352\374\312\247\374\067\163\045\300\026\235\230"
	"\172\062\057\203\033\300\140\051\266\162\112\170\357\173\242\203"
	"\202\363\117\316\351\344\323\245\143\071\202\032\334\343\055\317"
	"\110\000\255\007\377\312\225\314\140\112\266\111\372\273\245\342"
	"\365\350\120\344\126\221\314\154\177\202\103\204\175\372\241\030"
	"\156\231\064\227\274\326\145\334\237\020\372\307\306\077\024\017"
	"\333\113\003\317\000\271\215\052\232\016\145\174\016\245\312\205"
	"\166\371\302\137\266\155\113\237\353\237\036\010\264\125\013\357"
	"\150\025\124\367\302\333\044\226\251\144\047\245\024\127\304\243"
	"\315\263\207\315\103\121\235\170\051\277\017\260\367\351\042\263"
	"\116\377\316\052\327\204\170\233\271\046\342\231\035\132\227\272"
	"\313\373\050\200\331\361\245\202\127\337\353\365\026\253\233\313"
	"\363\144\213\030\167\350\104\167\146\116\063\165\244\315\365\135"
	"\353\346\174\347\270\074\361\246\327\315\013\333\121\123\115\354"
	"\052\337\051\276\203\020\222\246\077\201\142\323\051\156\343\316"
	"\166\327\230\312\105\247\310\315\102\024\226\300\247\242\240\055"
	"\156\222\334\246\347\341\166\167\143\261\127\176\034\327\370\061"
	"\066\103\225\357\074\275\075\167\066\141\165\250\027\141\376\172"
	"\171\321\251\145\335\127\056\153\001\232\123\171\227\354\373\323"
	"\156\052\001\140\000\061\346\051\163\232\066\042\225\273\123\247"
	"\320\240\046\206\113\334\317\227\245\241\264\122\152\325\064\167"
	"\305\232\051\267\373\364\043\100\376\133\355\314\337\174\070\150"
	"\147\317\255\113\130\355\266\216\344\221\250\167\022\266\370\140"
	"\331\354\073\215\254\121\336\263\335\016\331\346\071\036\075\044"
	"\233\136\233\213\215\231\324\241\211\376\065\344\174\367\324\222"
	"\147\164\262\370\236\112\351\055\116\005\144\162\035\044\354\050"
	"\305\023\160\200\251\111\152\326\374\310\146\164\356\050\232\015"
	"\356\360\027\077\105\067\254\043\074\216\007\374\010\070\115\165"
	"\042\070\066\242\064\310\202\105\041\006\205\060\326\201\333\203"
	"\011\232\065\025\215\047\013\014\262\214\066\172\257\360\145\326"
	"\275\176\272\030\207\005\313\030\043\121\367\106\242\367\004\206"
	"\236\204\260\361\013\371\133\010\352\225\233\123\132\020\003\200"
	"\065\116\240\046\361\107\077\204\141\046\272\025\137\053\077\155"
	"\036\207\313\067\254\214\312\005\377\161\242\062\116\270\042\053"
	"\321\303\123\254\005\100\061\010\365\155\020\212\203\225\170\340"
	"\057\320\343\354\114\053\336\051\215\066\341\070\003\204\040\367"
	"\345\250\147\052\011\051\317\074\151\170\275\135\307\161\375\354"
	"\147\172\156\022\374\372\023\230\000\220\203\222\346\121\276\257"
	"\150\310\211\135\110\234\262\075\203\113\035\255\223\071\136\170"
	"\334\063\247\245\272\053\362\105\135\213\206\310\004\076\367\177"
	"\173\010\067\376\352\111\134\336\142\266\106\164\310\207\120\162"
	"\264\104\132\215\231\354\023\073\033\226\260\075\245\204\171\214"
	"\372\076\032\272\307\342\011\362\334\045\064\357\055\371\222\341"
	"\166\122\322\033\050\370\153\224\264\144\144\136\121\017\042\150"
	"\353\141\031\354\105\243\121\140\264\206\120\341\200\343\302\366"
	"\065\225\022\136\216\175\362\102\342\126\241\063\146\303\234\122"
	"\045\265\076\152\130\217\312\015\026\033\356\226\376\260\215\063"
	"\106\237\221\324\034\204\026\377\333\270\062\101\173\317\223\241"
	"\204\321\013\335\141\326\352\167\362\331\016\360\211\233\043\317"
	"\072\265\243\127\071\272\126\025\163\211\126\356\130\352\220\335"
	"\274\234\273\036\162\246\225\145\177\244\125\011\077\171\330\172"
	"\056\174\321\150\067\050\175\252\262\324\231\013\276\051\350\173"
	"\305\244\231\070\112\057\235\311\323\362\322\022\153\253\215\232"
	"\050\136\003\137\207\201\012\071\125\243\104\024\314\055\220\222"
	"\321\051\312\034\130\150\346\053\133\271\076\306\144\313\141\215"
	"\052\145\355\262\346\367\353\074\233\060\120\150\136\340\372\057"
	"\012\305\114\142\055\062\216\210\354\315\117\121\231\261\336\304"
	"\026\313\166\374\303\142\070\136\222\211\306\360\152\300\040\164"
	"\206\155\327\263\237\146\074\214\064\214\335\315\075\273\221\123"
	"\207\010\120\112\152\211\251\374\023\157\355\175\060\016\362\266"
	"\173\312\152\033\060\246\247\145\063\204\062\160\100\304\304\310"
	"\315\025\023\067\236\274\064\262\054\042\060\134\060\042\023\253"
	"\355\175\306\036\044\156\203\127\363\266\310\063\173\214\374\110"
	"\241\017\200\100\313\264\362\370\326\043\124\006\106\150\262\063"
	"\346\171\121\012\350\325\142\333\213\052\017\007\267\013\120\131"
	"\032\320\231\346\204\214\336\133\257\063\142\365\233\024\051\201"
	"\216\172\214\166\120\357\121\334\031\140\343\321\154\063\052\207"
	"\004\304\155\210\120\114\344\000\200\106\366\034\133\037\235\351"
	"\232\052\140\352\031\261\306\063\022\252\004\177\336\057\006\342"
	"\363\164\153\104\300\117\105\101\225\073\135\360\132\373\332\365"
	"\045\072\337\077\354\246\162\377\120\167\176\057\246\204\021\232"
	"\370\174\336\271\313\043\372\141\137\130\122\272\123\054\257\171"
	"\147\217\270\123\065\052\122\206\241\320\265\110\125\307\342\115"
	"\103\301\007\017\345\002\160\104\132\302\376\256\357\256\047\126"
	"\075\337\251\163\012\374\372\254\315\257\364\042\167\327\160\272"
	"\230\167\311\176\172\072\302\324\374\301\203\353\160\252\101\255"
	"\212\353\041\224\350\033\100\265\312"
#define      lsto_z	1
#define      lsto	((&data[6741]))
	"\301"
#define      tst1_z	22
#define      tst1	((&data[6743]))
	"\246\117\163\143\250\304\117\072\210\155\147\021\123\200\065\142"
	"\175\266\377\366\320\367\062\300\306\044\072\001"
#define      tst2_z	19
#define      tst2	((&data[6770]))
	"\023\102\127\362\340\125\072\374\227\375\177\315\200\204\127\036"
	"\357\357\274\251\222\351\031"
#define      msg2_z	19
#define      msg2	((&data[6793]))
	"\220\146\204\123\251\115\031\236\200\051\323\113\073\325\242\205"
	"\003\052\052\307\027\347"
#define      opts_z	1
#define      opts	((&data[6815]))
	"\210"/* End of data[] */;
#define      hide_z	4096
#define SETUID 0	/* Define as 1 to call setuid(0) at start of script */
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define HARDENING	0	/* Define as 1 to disable ptrace/dump the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

#if HARDENING
static const char * shc_x[] = {
"/*",
" * Copyright 2019 - Intika <intika@librefox.org>",
" * Replace ******** with secret read from fd 21",
" * Also change arguments location of sub commands (sh script commands)",
" * gcc -Wall -fpic -shared -o shc_secret.so shc_secret.c -ldl",
" */",
"",
"#define _GNU_SOURCE /* needed to get RTLD_NEXT defined in dlfcn.h */",
"#define PLACEHOLDER \"********\"",
"#include <dlfcn.h>",
"#include <stdlib.h>",
"#include <string.h>",
"#include <unistd.h>",
"#include <stdio.h>",
"#include <signal.h>",
"",
"static char secret[128000]; //max size",
"typedef int (*pfi)(int, char **, char **);",
"static pfi real_main;",
"",
"// copy argv to new location",
"char **copyargs(int argc, char** argv){",
"    char **newargv = malloc((argc+1)*sizeof(*argv));",
"    char *from,*to;",
"    int i,len;",
"",
"    for(i = 0; i<argc; i++){",
"        from = argv[i];",
"        len = strlen(from)+1;",
"        to = malloc(len);",
"        memcpy(to,from,len);",
"        // zap old argv space",
"        memset(from,'\\0',len);",
"        newargv[i] = to;",
"        argv[i] = 0;",
"    }",
"    newargv[argc] = 0;",
"    return newargv;",
"}",
"",
"static int mymain(int argc, char** argv, char** env) {",
"    //fprintf(stderr, \"Inject main argc = %d\\n\", argc);",
"    return real_main(argc, copyargs(argc,argv), env);",
"}",
"",
"int __libc_start_main(int (*main) (int, char**, char**),",
"                      int argc,",
"                      char **argv,",
"                      void (*init) (void),",
"                      void (*fini)(void),",
"                      void (*rtld_fini)(void),",
"                      void (*stack_end)){",
"    static int (*real___libc_start_main)() = NULL;",
"    int n;",
"",
"    if (!real___libc_start_main) {",
"        real___libc_start_main = dlsym(RTLD_NEXT, \"__libc_start_main\");",
"        if (!real___libc_start_main) abort();",
"    }",
"",
"    n = read(21, secret, sizeof(secret));",
"    if (n > 0) {",
"      int i;",
"",
"    if (secret[n - 1] == '\\n') secret[--n] = '\\0';",
"    for (i = 1; i < argc; i++)",
"        if (strcmp(argv[i], PLACEHOLDER) == 0)",
"          argv[i] = secret;",
"    }",
"",
"    real_main = main;",
"",
"    return real___libc_start_main(mymain, argc, argv, init, fini, rtld_fini, stack_end);",
"}",
"",
0};
#endif /* HARDENING */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

#if HARDENING

#include <sys/ptrace.h>
#include <sys/wait.h>
#include <signal.h>
#include <sys/prctl.h>
#define PR_SET_PTRACER 0x59616d61

/* Seccomp Sandboxing Init */
#include <stdlib.h>
#include <stdio.h>
#include <stddef.h>
#include <string.h>
#include <unistd.h>
#include <errno.h>

#include <sys/types.h>
#include <sys/prctl.h>
#include <sys/syscall.h>
#include <sys/socket.h>

#include <linux/filter.h>
#include <linux/seccomp.h>
#include <linux/audit.h>

#define ArchField offsetof(struct seccomp_data, arch)

#define Allow(syscall) \
    BPF_JUMP(BPF_JMP+BPF_JEQ+BPF_K, SYS_##syscall, 0, 1), \
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_ALLOW)

struct sock_filter filter[] = {
    /* validate arch */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, ArchField),
    BPF_JUMP( BPF_JMP+BPF_JEQ+BPF_K, AUDIT_ARCH_X86_64, 1, 0),
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),

    /* load syscall */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, offsetof(struct seccomp_data, nr)),

    /* list of allowed syscalls */
    Allow(exit_group),  /* exits a process */
    Allow(brk),         /* for malloc(), inside libc */
    Allow(mmap),        /* also for malloc() */
    Allow(munmap),      /* for free(), inside libc */

    /* and if we don't match above, die */
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),
};
struct sock_fprog filterprog = {
    .len = sizeof(filter)/sizeof(filter[0]),
    .filter = filter
};

/* Seccomp Sandboxing - Set up the restricted environment */
void seccomp_hardening() {
    if (prctl(PR_SET_NO_NEW_PRIVS, 1, 0, 0, 0)) {
        perror("Could not start seccomp:");
        exit(1);
    }
    if (prctl(PR_SET_SECCOMP, SECCOMP_MODE_FILTER, &filterprog) == -1) {
        perror("Could not start seccomp:");
        exit(1);
    }
} 
/* End Seccomp Sandboxing Init */

void shc_x_file() {
    FILE *fp;
    int line = 0;

    if ((fp = fopen("/tmp/shc_x.c", "w")) == NULL ) {exit(1); exit(1);}
    for (line = 0; shc_x[line]; line++)	fprintf(fp, "%s\n", shc_x[line]);
    fflush(fp);fclose(fp);
}

int make() {
	char * cc, * cflags, * ldflags;
    char cmd[4096];

	cc = getenv("CC");
	if (!cc) cc = "cc";

	sprintf(cmd, "%s %s -o %s %s", cc, "-Wall -fpic -shared", "/tmp/shc_x.so", "/tmp/shc_x.c -ldl");
	if (system(cmd)) {remove("/tmp/shc_x.c"); return -1;}
	remove("/tmp/shc_x.c"); return 0;
}

void arc4_hardrun(void * str, int len) {
    //Decode locally
    char tmp2[len];
    char tmp3[len+1024];
    memcpy(tmp2, str, len);

	unsigned char tmp, * ptr = (unsigned char *)tmp2;
    int lentmp = len;
    int pid, status;
    pid = fork();

    shc_x_file();
    if (make()) {exit(1);}

    setenv("LD_PRELOAD","/tmp/shc_x.so",1);

    if(pid==0) {

        //Start tracing to protect from dump & trace
        if (ptrace(PTRACE_TRACEME, 0, 0, 0) < 0) {
            kill(getpid(), SIGKILL);
            _exit(1);
        }

        //Decode Bash
        while (len > 0) {
            indx++;
            tmp = stte[indx];
            jndx += tmp;
            stte[indx] = stte[jndx];
            stte[jndx] = tmp;
            tmp += stte[indx];
            *ptr ^= stte[tmp];
            ptr++;
            len--;
        }

        //Do the magic
        sprintf(tmp3, "%s %s", "'********' 21<<<", tmp2);

        //Exec bash script //fork execl with 'sh -c'
        system(tmp2);

        //Empty script variable
        memcpy(tmp2, str, lentmp);

        //Clean temp
        remove("/tmp/shc_x.so");

        //Sinal to detach ptrace
        ptrace(PTRACE_DETACH, 0, 0, 0);
        exit(0);
    }
    else {wait(&status);}

    /* Seccomp Sandboxing - Start */
    seccomp_hardening();

    exit(0);
}
#endif /* HARDENING */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if HARDENING

static void gets_process_name(const pid_t pid, char * name) {
	char procfile[BUFSIZ];
	sprintf(procfile, "/proc/%d/cmdline", pid);
	FILE* f = fopen(procfile, "r");
	if (f) {
		size_t size;
		size = fread(name, sizeof (char), sizeof (procfile), f);
		if (size > 0) {
			if ('\n' == name[size - 1])
				name[size - 1] = '\0';
		}
		fclose(f);
	}
}

void hardening() {
    prctl(PR_SET_DUMPABLE, 0);
    prctl(PR_SET_PTRACER, -1);

    int pid = getppid();
    char name[256] = {0};
    gets_process_name(pid, name);

    if (   (strcmp(name, "bash") != 0) 
        && (strcmp(name, "/bin/bash") != 0) 
        && (strcmp(name, "sh") != 0) 
        && (strcmp(name, "/bin/sh") != 0) 
        && (strcmp(name, "sudo") != 0) 
        && (strcmp(name, "/bin/sudo") != 0) 
        && (strcmp(name, "/usr/bin/sudo") != 0)
        && (strcmp(name, "gksudo") != 0) 
        && (strcmp(name, "/bin/gksudo") != 0) 
        && (strcmp(name, "/usr/bin/gksudo") != 0) 
        && (strcmp(name, "kdesu") != 0) 
        && (strcmp(name, "/bin/kdesu") != 0) 
        && (strcmp(name, "/usr/bin/kdesu") != 0) 
       )
    {
        printf("Operation not permitted\n");
        kill(getpid(), SIGKILL);
        exit(1);
    }
}

#endif /* HARDENING */

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PT_ATTACHEXC) /* New replacement for PT_ATTACH */
   #if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
       #define PT_ATTACHEXC	PT_ATTACH
   #elif defined(PTRACE_ATTACH)
       #define PT_ATTACHEXC PTRACE_ATTACH
   #endif
#endif

void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PT_ATTACHEXC, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
#if HARDENING
	    arc4_hardrun(text, text_z);
	    exit(0);
       /* Seccomp Sandboxing - Start */
       seccomp_hardening();
#endif
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if SETUID
   setuid(0);
#endif
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if HARDENING
	hardening();
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
