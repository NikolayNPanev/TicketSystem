#if 0
	shc Version 4.0.3, Generic Shell Script Compiler
	GNU GPL Version 3 Md Jahidul Hamid <jahidulhamid@yahoo.com>

	shc -f ./src/ticksys.sh -o ./bin/ticket 
#endif

static  char data [] = 
#define      opts_z	1
#define      opts	((&data[0]))
	"\343"
#define      chk1_z	22
#define      chk1	((&data[1]))
	"\301\126\315\357\122\370\050\237\321\346\252\010\245\245\275\113"
	"\007\350\372\324\207\131\147\114\122\101"
#define      tst2_z	19
#define      tst2	((&data[29]))
	"\041\174\230\245\007\200\156\317\364\140\167\240\031\021\110\023"
	"\106\331\214\224\362\100"
#define      xecc_z	15
#define      xecc	((&data[52]))
	"\122\075\222\122\070\264\327\033\370\107\111\002\314\106\113\076"
	"\053\067"
#define      lsto_z	1
#define      lsto	((&data[67]))
	"\077"
#define      shll_z	10
#define      shll	((&data[69]))
	"\055\215\374\157\305\207\367\365\266\330\251"
#define      msg2_z	19
#define      msg2	((&data[79]))
	"\112\120\026\366\023\014\323\332\276\142\125\161\123\222\334\070"
	"\305\054\263\150\243\201\164"
#define      tst1_z	22
#define      tst1	((&data[107]))
	"\252\052\252\103\173\155\217\252\311\311\120\031\256\030\121\047"
	"\020\130\361\232\235\107\306\172\206\371\054\313\277\273\041"
#define      rlax_z	1
#define      rlax	((&data[133]))
	"\303"
#define      chk2_z	19
#define      chk2	((&data[135]))
	"\363\032\364\054\102\164\240\257\116\346\263\345\103\105\340\032"
	"\033\125\324\243\234\012\211"
#define      text_z	5555
#define      text	((&data[459]))
	"\365\044\202\230\245\366\360\216\267\233\270\141\336\063\055\236"
	"\357\116\125\254\303\110\373\217\073\227\232\305\151\322\336\136"
	"\366\140\367\233\127\350\051\016\203\341\160\142\025\235\001\004"
	"\354\126\260\260\237\254\077\332\104\331\240\255\253\176\013\242"
	"\337\002\075\066\352\146\105\156\110\266\321\136\123\322\142\100"
	"\051\023\360\310\277\060\243\003\012\103\261\266\302\274\130\241"
	"\277\225\330\251\374\036\030\105\324\351\243\047\274\006\150\345"
	"\032\130\255\332\211\120\336\223\224\217\111\126\113\241\370\012"
	"\067\321\264\063\357\315\171\303\266\034\353\162\043\123\130\075"
	"\254\005\027\065\126\365\310\352\204\022\101\320\263\071\333\353"
	"\012\220\036\372\135\230\275\024\264\251\207\330\374\337\025\251"
	"\345\055\337\074\042\247\046\247\272\150\167\155\241\123\130\254"
	"\343\167\247\101\017\145\126\304\016\335\234\013\275\262\264\243"
	"\337\223\337\002\073\006\251\365\156\041\143\020\164\274\275\130"
	"\064\144\232\104\311\360\010\327\315\245\342\213\130\227\056\067"
	"\053\015\071\146\023\342\134\201\004\300\222\171\174\117\321\260"
	"\263\154\365\174\134\375\124\052\243\067\265\373\316\344\063\371"
	"\362\154\140\005\117\275\207\123\175\031\314\371\151\236\252\034"
	"\013\237\231\147\235\356\221\101\045\107\075\363\054\160\070\374"
	"\132\163\205\100\163\034\221\242\235\006\346\002\363\340\242\264"
	"\361\331\364\141\311\063\366\025\122\130\034\034\351\044\171\346"
	"\354\240\231\076\121\067\314\015\360\276\310\136\261\331\363\112"
	"\101\076\144\162\202\263\153\120\131\012\341\324\114\352\130\125"
	"\332\204\203\254\242\106\104\315\052\242\244\351\264\010\210\354"
	"\325\216\130\046\301\332\250\106\103\011\340\370\225\110\262\113"
	"\202\003\121\157\037\167\133\147\332\005\064\005\105\057\173\372"
	"\064\035\033\176\216\341\123\253\025\137\200\334\056\301\245\143"
	"\244\366\125\225\016\301\361\167\052\123\140\120\221\261\235\021"
	"\005\125\333\132\251\246\314\162\303\031\025\345\034\276\103\232"
	"\367\241\141\205\027\301\262\056\244\057\045\122\275\270\375\303"
	"\162\257\155\250\116\006\237\246\022\144\271\176\135\126\324\151"
	"\110\117\047\372\266\117\046\215\364\315\005\230\331\303\032\046"
	"\175\234\057\154\043\230\365\143\030\004\367\205\321\243\143\065"
	"\161\313\213\114\162\326\112\114\203\200\372\202\250\172\373\217"
	"\300\177\260\276\035\116\017\042\171\125\311\123\200\104\025\076"
	"\144\232\043\220\036\154\230\022\375\327\332\274\137\330\275\022"
	"\266\363\255\223\257\055\354\022\260\336\065\155\312\247\357\013"
	"\164\265\302\225\007\145\175\334\022\123\305\055\012\113\015\136"
	"\322\173\123\024\260\075\234\352\222\132\150\266\135\374\323\267"
	"\340\262\137\211\242\267\064\271\146\043\021\366\062\007\056\137"
	"\364\105\244\042\334\255\313\257\040\301\100\020\236\212\264\341"
	"\220\042\172\074\345\330\256\275\176\050\300\217\134\115\000\334"
	"\163\273\070\216\304\261\203\172\050\061\070\312\064\014\132\150"
	"\053\050\060\366\353\207\032\322\264\201\315\320\055\320\133\362"
	"\061\325\122\010\016\066\035\304\137\357\274\110\276\215\216\126"
	"\256\352\216\303\041\206\224\155\360\274\132\235\276\147\230\346"
	"\110\172\002\242\354\275\134\340\065\033\255\005\345\125\232\027"
	"\317\257\175\276\045\302\173\340\257\316\140\361\350\265\332\115"
	"\300\270\046\260\357\063\135\004\232\152\157\214\271\044\040\147"
	"\060\254\115\071\127\313\102\313\254\246\123\153\067\152\174\012"
	"\212\157\271\236\152\253\060\115\325\301\237\136\363\145\227\257"
	"\206\352\033\241\177\276\121\264\347\231\077\271\222\134\016\007"
	"\203\326\233\332\343\112\154\046\020\207\217\141\033\233\012\341"
	"\303\216\056\067\135\210\016\141\271\121\377\343\302\177\173\050"
	"\370\376\241\340\000\057\311\161\173\170\147\311\335\271\057\341"
	"\323\366\371\265\236\307\313\236\305\262\013\271\043\135\015\100"
	"\201\155\147\143\114\117\276\247\147\011\032\343\345\210\314\171"
	"\114\253\374\374\053\077\351\311\172\064\023\143\324\212\300\067"
	"\132\221\002\200\331\164\133\300\335\021\336\356\026\333\101\102"
	"\122\224\245\364\201\027\077\377\342\057\001\022\166\200\352\105"
	"\221\141\020\262\337\027\144\276\032\042\223\041\107\030\165\205"
	"\110\220\146\057\014\304\243\234\336\176\167\307\066\130\335\143"
	"\222\036\211\103\000\355\060\113\147\352\107\143\116\051\256\326"
	"\230\375\274\103\002\234\165\074\274\010\033\205\271\010\072\011"
	"\344\271\114\334\371\250\115\122\110\310\350\141\167\376\373\244"
	"\025\311\264\073\037\371\205\330\302\051\141\137\367\063\146\314"
	"\302\051\045\013\067\103\055\057\353\137\110\044\045\212\206\166"
	"\170\146\064\333\217\115\105\040\127\153\055\245\116\115\140\213"
	"\045\272\105\174\105\026\155\120\200\143\104\233\255\026\160\020"
	"\203\140\176\160\336\332\160\177\212\163\116\343\130\062\316\214"
	"\302\237\221\275\116\004\103\077\046\301\036\302\011\362\313\076"
	"\056\125\243\310\257\120\105\007\206\352\101\221\253\030\255\131"
	"\274\041\340\321\364\067\254\202\073\002\076\162\067\047\051\260"
	"\145\063\237\325\013\136\270\213\063\101\345\277\357\053\177\166"
	"\275\011\103\370\015\014\117\137\307\247\065\252\060\225\074\076"
	"\122\245\144\311\015\340\356\321\073\207\255\346\130\121\337\340"
	"\021\354\040\276\131\330\331\015\225\273\152\256\253\362\050\273"
	"\333\353\046\005\260\350\126\344\104\004\170\217\364\241\360\306"
	"\135\316\252\343\200\002\144\243\101\075\146\077\230\274\001\303"
	"\014\211\012\174\133\306\315\361\044\343\272\235\020\217\302\246"
	"\360\226\144\232\035\341\007\312\275\040\163\225\365\124\103\365"
	"\164\225\162\172\017\324\316\030\371\254\342\236\043\021\143\043"
	"\043\124\043\347\370\347\066\202\312\151\100\361\250\072\356\317"
	"\126\005\173\227\120\211\046\313\102\055\170\302\137\370\341\134"
	"\032\201\323\346\356\252\072\063\036\365\055\300\363\223\226\027"
	"\056\361\214\201\304\166\276\063\022\314\210\204\304\331\077\121"
	"\111\067\110\125\255\002\227\324\115\036\014\256\373\265\100\006"
	"\165\234\161\365\164\256\174\172\266\146\234\212\066\270\352\126"
	"\105\222\061\204\252\374\342\343\034\225\377\371\320\070\144\240"
	"\045\227\010\161\130\256\157\364\016\075\372\131\247\230\050\251"
	"\223\100\267\113\030\214\257\277\132\364\100\106\145\014\334\146"
	"\120\034\033\152\130\224\314\237\242\375\372\276\376\253\371\331"
	"\143\132\012\242\331\367\265\001\370\214\365\102\173\336\034\364"
	"\045\103\317\332\371\074\147\062\004\106\107\102\032\355\033\341"
	"\353\272\174\225\007\261\042\277\034\010\277\174\017\300\346\354"
	"\015\122\156\074\142\246\223\203\352\340\240\362\150\231\372\251"
	"\344\215\145\135\373\014\360\216\346\174\270\300\160\015\117\262"
	"\145\244\024\031\270\204\312\327\237\205\126\340\373\310\270\120"
	"\115\265\064\015\174\121\115\047\242\321\076\247\127\021\162\271"
	"\125\317\263\340\075\260\221\136\162\201\002\344\311\177\371\167"
	"\352\277\354\374\046\016\001\365\056\061\334\352\307\306\077\170"
	"\247\313\037\126\102\347\131\277\250\307\116\031\165\320\014\075"
	"\376\160\154\137\111\247\375\157\244\315\213\132\175\263\174\065"
	"\354\135\122\363\156\307\245\334\167\037\270\256\065\046\160\001"
	"\174\363\015\172\144\010\112\330\247\227\120\262\014\114\364\162"
	"\216\036\072\174\150\264\247\022\225\116\271\060\060\213\063\204"
	"\322\254\070\352\121\056\205\071\374\311\000\251\047\013\317\044"
	"\107\130\264\276\064\313\277\212\071\156\254\153\144\372\262\323"
	"\211\264\346\252\254\222\236\337\301\022\264\252\024\133\337\060"
	"\023\034\106\137\073\115\120\173\124\165\006\150\051\134\320\265"
	"\162\164\217\112\337\014\263\012\360\057\166\302\357\042\066\153"
	"\271\050\232\136\110\217\306\021\171\332\110\331\044\011\254\074"
	"\265\207\056\355\203\100\016\225\207\177\332\221\066\076\350\151"
	"\072\123\151\237\174\155\033\254\346\105\274\061\114\174\155\163"
	"\375\116\116\132\276\200\321\042\121\163\053\313\025\046\254\211"
	"\074\206\135\165\007\214\363\160\237\113\014\214\063\077\045\327"
	"\033\375\004\266\162\015\142\007\216\152\274\041\175\036\161\075"
	"\345\031\162\327\311\367\200\227\221\124\115\204\160\043\146\303"
	"\346\371\044\277\131\117\263\046\264\223\323\025\131\072\363\307"
	"\233\012\150\315\220\150\176\132\073\217\132\155\165\010\245\377"
	"\347\057\275\177\063\225\051\172\251\024\277\256\237\360\337\001"
	"\203\313\144\120\111\300\155\126\134\103\317\274\133\274\221\271"
	"\322\013\013\202\337\123\206\205\067\060\306\307\205\330\060\105"
	"\275\015\116\077\256\237\315\071\022\356\000\331\225\132\251\045"
	"\002\043\041\147\113\125\257\110\332\110\174\217\165\330\156\251"
	"\145\143\315\001\314\354\055\105\023\362\334\023\201\356\133\150"
	"\015\043\265\170\272\305\070\000\230\124\077\265\002\274\250\265"
	"\060\353\201\272\341\364\065\172\331\065\016\062\367\355\271\101"
	"\235\227\120\052\222\320\035\161\257\361\353\162\034\263\336\241"
	"\051\036\354\311\202\037\222\377\137\212\176\003\237\320\036\333"
	"\151\011\331\143\114\345\053\031\272\334\330\302\221\025\100\055"
	"\332\041\136\025\336\152\252\173\346\016\340\065\313\370\162\012"
	"\166\131\037\121\216\375\161\013\207\006\347\344\334\203\125\071"
	"\022\343\072\002\246\044\377\361\034\206\344\127\251\275\357\302"
	"\343\110\327\326\366\016\223\272\103\333\071\140\111\113\070\013"
	"\360\133\050\135\172\217\323\367\264\077\064\070\015\050\057\074"
	"\044\247\250\327\063\350\055\131\305\061\373\153\016\337\127\142"
	"\061\033\063\357\050\007\022\343\077\242\032\100\152\171\277\043"
	"\345\066\342\342\314\176\103\045\245\150\324\350\352\150\231\151"
	"\205\244\367\113\364\334\046\130\110\151\133\345\245\207\314\035"
	"\016\161\155\000\111\156\101\264\036\137\315\171\117\026\043\152"
	"\226\222\027\177\012\134\336\025\142\165\011\253\073\001\251\254"
	"\170\202\032\324\150\114\171\363\002\135\325\201\303\125\230\135"
	"\006\017\100\056\322\126\262\161\265\157\130\024\004\203\124\334"
	"\317\032\157\271\064\255\331\042\251\177\062\146\270\163\242\207"
	"\247\162\206\324\311\144\063\107\201\073\347\113\010\035\124\342"
	"\117\351\010\302\243\212\010\004\257\000\367\253\321\065\163\011"
	"\030\263\140\015\251\254\014\075\362\007\052\144\210\220\346\073"
	"\031\253\312\126\034\137\166\106\321\305\342\316\057\264\227\335"
	"\204\013\347\372\307\300\044\355\356\303\131\357\326\343\134\367"
	"\275\171\354\271\374\247\047\113\360\155\031\366\222\014\011\223"
	"\166\320\034\011\013\307\164\274\251\152\347\135\361\015\026\231"
	"\153\151\320\370\257\261\045\364\242\360\341\172\360\053\351\074"
	"\231\363\020\336\277\156\372\357\230\201\027\157\254\207\365\316"
	"\374\277\132\215\353\123\317\057\131\210\015\157\372\052\374\252"
	"\363\277\076\006\374\250\371\003\122\223\210\271\271\047\025\101"
	"\263\311\033\071\273\166\306\065\226\310\373\122\276\274\115\070"
	"\170\210\176\233\004\140\111\364\207\200\131\316\230\372\350\021"
	"\230\110\113\264\162\077\360\320\346\164\006\234\361\032\312\077"
	"\230\207\127\027\024\153\160\006\212\020\215\252\050\157\026\057"
	"\376\320\200\154\014\143\057\033\023\337\356\055\106\157\054\304"
	"\112\242\260\301\102\114\065\056\255\046\061\377\346\030\032\033"
	"\075\064\215\245\302\150\261\157\140\311\056\263\044\005\304\241"
	"\032\076\326\330\135\140\252\116\006\061\246\146\357\152\034\366"
	"\225\124\305\144\003\216\135\102\210\153\127\376\041\214\072\135"
	"\143\177\126\245\332\124\023\331\331\172\162\110\201\132\231\274"
	"\216\151\270\312\273\322\124\007\341\356\313\273\020\331\135\015"
	"\026\057\075\164\333\127\233\344\054\235\074\073\303\256\235\016"
	"\302\313\017\014\240\315\145\341\166\137\071\321\071\263\125\335"
	"\213\076\304\350\253\311\276\101\146\042\137\001\356\060\125\254"
	"\230\100\055\366\370\244\064\034\325\124\314\264\346\115\061\237"
	"\034\167\007\142\005\113\227\241\031\303\152\360\144\261\373\331"
	"\042\126\240\130\071\121\172\104\270\146\352\221\242\371\376\055"
	"\044\134\112\026\033\304\236\033\143\361\252\010\171\002\165\052"
	"\014\171\302\361\252\375\005\154\136\341\024\244\323\336\150\053"
	"\267\231\276\376\227\021\071\174\131\042\375\243\353\154\177\307"
	"\200\233\060\141\320\200\101\345\010\227\264\261\107\135\257\032"
	"\330\351\243\131\316\012\020\200\013\353\143\141\325\254\354\031"
	"\325\061\071\234\342\127\140\251\336\217\301\056\312\246\007\361"
	"\201\306\223\240\177\270\204\172\272\326\011\045\116\111\357\167"
	"\377\030\104\330\063\116\332\264\164\075\356\307\064\322\322\343"
	"\332\243\003\124\225\061\212\345\133\276\256\275\076\204\301\101"
	"\034\313\212\064\010\253\355\115\364\315\126\340\202\112\030\073"
	"\031\375\213\146\303\134\174\340\012\135\070\144\352\205\311\360"
	"\246\204\170\157\200\165\134\321\174\340\337\354\165\046\220\340"
	"\107\117\101\142\254\052\215\130\035\025\265\107\036\055\314\162"
	"\152\262\332\237\060\022\001\227\210\162\104\320\365\010\300\210"
	"\231\306\141\150\370\017\266\117\321\264\144\164\261\031\026\172"
	"\206\026\166\204\326\357\377\156\357\001\153\206\201\350\252\377"
	"\074\161\366\270\222\113\070\111\240\006\132\060\023\177\163\312"
	"\332\257\070\275\335\325\071\072\264\140\325\057\000\067\156\276"
	"\031\120\234\126\260\226\303\210\010\023\121\313\341\276\250\344"
	"\257\250\053\071\271\262\040\061\364\023\134\143\214\014\132\126"
	"\275\244\235\224\100\054\317\055\375\335\272\147\051\115\331\204"
	"\312\241\315\141\266\162\010\032\210\174\003\254\362\015\245\342"
	"\217\175\255\113\004\124\322\377\202\121\204\120\315\037\063\041"
	"\067\243\244\015\066\271\217\365\345\303\044\345\076\215\133\102"
	"\024\111\141\034\255\234\321\300\032\340\162\014\110\235\060\130"
	"\174\300\121\125\257\117\105\250\060\133\204\120\117\022\226\271"
	"\216\026\123\346\105\225\021\020\002\063\062\101\162\071\244\112"
	"\117\060\347\112\217\101\364\046\073\332\176\122\210\254\234\006"
	"\226\212\327\203\122\146\334\230\014\220\216\210\335\263\175\130"
	"\011\053\174\251\213\165\167\307\066\270\305\120\226\324\167\163"
	"\326\220\012\152\001\260\061\222\204\314\347\165\212\314\073\017"
	"\203\071\175\200\370\054\060\316\011\013\125\223\243\166\324\077"
	"\236\127\377\304\137\013\050\113\255\257\105\203\232\071\271\337"
	"\104\137\074\161\102\232\300\322\306\202\025\107\215\241\215\230"
	"\255\250\065\016\011\033\014\007\214\144\214\252\260\364\142\262"
	"\350\361\264\106\210\117\207\216\216\226\051\360\236\305\163\146"
	"\205\174\164\233\361\237\247\100\317\071\372\317\204\016\015\073"
	"\205\111\357\014\330\057\027\016\310\074\336\252\120\345\100\045"
	"\255\022\344\365\312\224\320\233\066\347\160\130\031\145\175\107"
	"\336\155\125\035\345\151\300\076\277\142\337\104\062\325\173\237"
	"\315\232\261\372\011\247\207\004\223\054\044\151\256\025\041\067"
	"\236\063\370\325\201\370\202\251\263\176\164\015\336\271\026\357"
	"\117\213\023\302\206\311\356\334\156\141\333\013\257\113\014\026"
	"\017\163\342\242\357\237\074\210\233\005\237\147\207\350\325\265"
	"\227\320\056\065\346\215\054\375\154\202\062\166\136\300\310\314"
	"\352\117\057\070\311\236\243\061\056\203\177\251\223\173\103\342"
	"\070\157\024\345\105\366\147\377\223\214\047\013\310\154\270\151"
	"\032\330\227\111\122\340\362\263\101\246\014\107\313\225\252\135"
	"\102\036\362\131\340\042\144\276\265\347\305\133\125\263\151\030"
	"\300\312\003\162\360\271\033\350\323\074\357\047\117\273\314\020"
	"\214\201\344\234\357\117\204\117\166\031\143\173\143\117\153\337"
	"\144\347\236\010\254\264\234\000\321\351\154\144\316\346\245\165"
	"\177\251\265\306\037\202\232\241\262\356\200\213\065\174\350\170"
	"\324\034\222\302\345\006\025\147\233\021\011\037\242\025\252\074"
	"\123\162\216\051\222\130\010\063\136\041\052\175\025\167\003\257"
	"\342\364\322\330\341\241\265\272\066\351\020\174\254\213\373\370"
	"\022\111\060\313\023\050\171\061\215\217\367\065\063\201\100\026"
	"\202\077\141\217\071\301\225\146\205\264\107\041\074\114\066\363"
	"\370\257\113\240\110\237\101\331\322\064\105\255\240\277\073\354"
	"\001\377\072\166\012\152\246\306\004\005\020\263\061\103\262\302"
	"\066\324\045\354\064\250\011\027\142\237\115\231\045\011\201\153"
	"\053\315\214\274\063\014\210\105\145\100\350\236\301\375\240\167"
	"\302\075\154\046\160\116\350\353\356\236\241\253\016\330\106\050"
	"\117\254\035\266\261\001\304\164\347\143\067\231\320\163\236\115"
	"\327\315\116\307\207\323\255\164\353\162\015\355\135\212\302\364"
	"\237\250\061\263\235\251\227\355\231\365\175\167\213\013\246\020"
	"\164\144\220\241\155\147\241\017\341\324\137\173\134\175\045\210"
	"\025\163\021\331\023\054\022\231\063\336\376\213\203\053\022\227"
	"\006\153\207\212\327\052\330\212\157\153\057\144\261\221\200\031"
	"\053\374\253\266\144\152\216\054\131\061\344\211\346\223\266\145"
	"\336\374\342\203\340\251\026\067\023\274\261\270\276\032\100\037"
	"\005\040\077\365\177\346\110\056\015\333\162\366\162\221\353\150"
	"\020\075\120\070\041\037\067\054\030\303\301\361\312\336\012\070"
	"\333\313\253\224\036\230\045\117\114\136\303\155\236\327\156\172"
	"\353\110\144\350\066\025\200\221\040\035\014\141\375\377\162\347"
	"\255\325\017\123\114\325\374\222\317\134\124\101\213\365\212\061"
	"\033\256\234\274\152\125\074\026\232\207\257\064\302\306\027\364"
	"\257\324\247\055\003\366\336\122\120\010\245\273\171\076\257\352"
	"\071\127\342\214\361\316\006\156\061\030\356\077\214\230\076\101"
	"\315\354\310\023\154\027\213\265\341\051\142\017\347\041\225\206"
	"\277\222\376\327\134\113\256\207\037\040\025\351\053\162\033\010"
	"\265\304\132\062\100\134\055\013\212\111\163\311\031\201\346\217"
	"\314\174\127\206\057\253\114\016\247\237\147\264\377\260\033\311"
	"\163\013\360\145\307\042\244\314\367\046\001\362\143\172\133\332"
	"\201\157\345\037\214\225\057\132\371\304\072\344\174\131\150\157"
	"\216\273\242\351\315\117\052\202\375\365\344\245\134\245\201\120"
	"\124\364\030\372\312\112\021\161\227\257\375\115\076\003\331\122"
	"\230\154\136\065\005\134\075\262\377\255\354\006\113\251\123\123"
	"\231\251\161\171\216\366\101\127\056\133\327\017\254\076\104\301"
	"\306\305\147\252\062\327\052\317\004\316\256\201\217\130\303\035"
	"\321\376\074\067\024\314\353\252\275\027\276\135\350\231\101\057"
	"\032\241\363\177\023\104\364\132\225\076\074\265\256\024\341\325"
	"\235\152\176\343\324\177\126\242\375\231\202\070\043\275\364\337"
	"\003\237\315\156\177\260\351\124\073\040\042\131\323\260\214\213"
	"\321\131\022\146\253\363\046\076\300\310\175\206\336\012\265\221"
	"\106\003\365\120\156\137\123\365\310\151\076\116\143\275\255\107"
	"\206\314\334\335\377\101\272\050\032\131\063\237\253\101\315\033"
	"\173\241\117\363\233\310\144\247\065\163\107\231\305\257\207\200"
	"\104\025\136\007\273\306\073\335\366\030\206\072\303\100\273\143"
	"\202\374\035\002\037\055\034\302\365\120\344\016\227\124\372\242"
	"\277\126\061\251\022\342\240\261\015\233\040\052\101\350\000\250"
	"\274\361\003\240\275\031\241\175\247\217\342\205\205\062\213\377"
	"\250\350\110\370\050\251\110\005\152\253\060\222\024\176\155\253"
	"\270\243\240\271\045\351\175\017\365\350\262\345\141\100\176\254"
	"\031\271\372\061\325\041\204\250\035\016\274\304\105\327\246\316"
	"\027\355\361\027\253\304\152\317\273\101\060\016\133\333\174\122"
	"\260\205\311\150\063\056\141\150\221\301\110\336\350\375\243\152"
	"\007\341\122\337\361\051\043\055\266\325\137\355\060\045\150\070"
	"\315\310\206\052\210\267\340\153\057\013\350\103\070\226\225\230"
	"\004\203\211\131\334\057\151\121\110\221\006\041\203\173\152\102"
	"\104\106\161\317\244\220\262\222\056\135\063\003\147\327\121\213"
	"\061\201\275\030\074\045\327\223\232\327\037\110\302\322\126\037"
	"\004\204\054\041\006\246\154\217\330\223\107\023\017\011\142\037"
	"\170\042\371\106\216\064\276\171\133\344\041\145\211\376\350\202"
	"\370\030\111\361\157\321\063\027\005\331\256\375\162\066\010\135"
	"\237\063\357\163\100\334\307\143\100\377\103\203\271\355\137\002"
	"\172\263\307\250\002\323\306\373\166\262\245\206\045\130\373\204"
	"\103\145\237\117\130\174\035\130\012\304\247\005\176\032\137\000"
	"\073\207\133\151\063\215\011\024\332\102\123\031\312\043\116\053"
	"\351\134\103\274\357\370\370\303\217\354\267\173\313\065\176\011"
	"\166\245\201\331\340\315\112\056\015\251\323\100\251\067\145\261"
	"\060\216\351\033\043\046\172\246\167\025\121\025\137\031\173\207"
	"\307\346\340\242\064\132\064\013\112\112\235\310\113\342\034\256"
	"\145\304\373\176\126\166\142\147\334\071\164\156\242\135\262\271"
	"\126\167\221\232\105\370\273\067\030\324\030\164\141\244\142\105"
	"\266\020\312\233\103\331\207\101\062\323\225\271\210\344\206\376"
	"\226\116\071\217\001\303\172\101\075\314\142\111\051\106\200\170"
	"\275\156\155\044\344\355\162\245\160\275\202\246\015\102\046\153"
	"\255\276\376\364\347\207\103\223\111\232\150\302\367\067\321\034"
	"\160\056\353\377\031\263\055\234\073\243\367\126\137\003\325\264"
	"\013\202\311\006\032\072\345\374\154\227\276\050\066\123\127\255"
	"\241\135\360\006\044\171\176\340\304\355\101\160\073\235\045\260"
	"\254\372\372\220\357\144\034\024\001\137\074\126\263\050\217\043"
	"\125\343\126\003\241\350\370\055\037\321\031\014\271\013\234\137"
	"\170\253\210\237\351\110\323\060\101\164\241\011\274\265\301\276"
	"\377\054\362\054\304\254\166\164\264\014\357\102\234\170\130\234"
	"\022\310\122\143\257\336\054\357\055\243\243\147\225\012\266\032"
	"\006\011\154\231\341\361\341\301\041\321\215\075\373\153\133\140"
	"\312\313\212\072\137\227\302\304\135\220\124\121\300\277\203\346"
	"\047\016\070\156\006\342\160\041\167\116\004\175\344\365\043\037"
	"\254\205\203\115\221\142\335\260\116\341\137\313\127\065\266\163"
	"\377\042\354\104\011\077\327\021\051\151\316\041\012\364\365\370"
	"\120\257\275\016\135\104\306\122\360\044\260\125\231\200\312\304"
	"\143\243\352\303\276\323\141\071\053\107\051\055\136\100\040\260"
	"\013\221\213\335\277\055\224\253\073\243\375\237\333\145\131\364"
	"\105\045\215\161\041\331\365\203\271\235\131\362\144\153\335\371"
	"\344\252\366\021\141\051\155\124\265\110\236\030\356\312\313\334"
	"\303\226\160\327\370\151\342\234\262\346\007\106\351\017\010\311"
	"\060\112\236\052\212\275\334\243\024\301\143\106\047\231\025\160"
	"\357\327\007\370\303\011\043\037\251\060\374\147\237\373\311\201"
	"\120\035\153\320\124\345\045\116\207\327\172\201\302\265\225\211"
	"\323\311\140\005\371\041\103\350\337\257\337\024\053\036\137\243"
	"\204\106\042\102\312\147\335\345\150\254\311\377\333\032\156\243"
	"\105\312\032\115\227\102\341\114\152\130\224\063\334\011\255\154"
	"\310\316\043\214\126\164\314\126\100\074\023\334\343\003\333\333"
	"\043\304\027\067\202\212\154\022\245\001\307\350\240\141\016\056"
	"\323\155\101\227\072\012\327\015\135\146\177\005\146\233\276\052"
	"\276\246\115\111\216\345\071\111\255\343\270\235\173\235\253\041"
	"\053\337\321\154\267\313\323\226\312\071\363\363\210\013\050\175"
	"\213\125\303\256\075\260\126\151\313\224\143\035\073\041\175\316"
	"\302\276\024\147\171\054\034\276\245\300\133\257\165\012\105\307"
	"\065\012\177\361\063\266\047\207\026\320\375\061\163\010\116\146"
	"\367\220\334\260\056\001\046\235\327\116\030\146\262\126\375\170"
	"\263\037\226\257\273\153\111\164\170\161\144\046\250\072\244\200"
	"\122\222\154\374\206\356\341\017\112\061\042\143\225\275\141\335"
	"\056\002\077\235\031\011\374\226\370\171\001\234\201\260\036\047"
	"\117\261\264\205\173\370\244\357\363\206\327\371\327\375\355\100"
	"\320\052\323\162\155\142\256\315\164\222\300\163\355\257\141\376"
	"\251\141\247\260\024\102\265\060\003\157\365\045\054\204\072\247"
	"\216\151\216\003\164\317\153\076\052\063\163\237\330\073\257\260"
	"\046\275\227\363\112\014\263\355\332\142\234\143\355\126\056\120"
	"\147\125\357\371\207\103\242\321\132\377\014\030\313\243\152\015"
	"\132\042\014\073\275\132\222\146\363\000\075\305\137\327\163\121"
	"\256\366\067\300\174\243\331\212\243\162\322\073\300\030\211\121"
	"\136\324\315\121\251\210\254\151\245\265\237\061\152\071\127\102"
	"\272\026\117\152\056\332\101\177\312\200\224\021\303\254\103\315"
	"\374\124\076\120\253\043\106\177\003\276\117\235\016\061\307\072"
	"\332\063\244\162\345\063\273\126\001\317\313\310\357\112\352\067"
	"\215\364\161\110\363\372\171\151\324\314\251\016\131\340\007\014"
	"\204\035\243\223\244\007\102\356\351\032\023\314\340\172\215\173"
	"\212\143\043\067\021\076\125\370\364\277\231\376\306\207\206\013"
	"\124\110\320\154\267\331\333\370\140\221\176\244\304\256\064\165"
	"\255\206\004\135\220\310\234\026\227\243\140\153\212\154\245\064"
	"\341\206\156\332\340\273\366\222\367\051\034\206\207\051\037\217"
	"\307\210\304\066\153\224\154\215\032\333\322\342\376\345\112\056"
	"\270\370\272\073\256\142\125\145\105\101\017\272\047\274\047\100"
	"\040\131\050\075\015\234\346\131\235\233\035\052\040\370\022\142"
	"\106\023\317\125\175\143\014\271\367\036\331\167\276\016\373\014"
	"\205\340\171\370\311\210\077\266\316\102\163\057\252\375\237\206"
	"\022\216\024\123\020\100\321\062\271\162\071\371\066\220\116\220"
	"\353\117\017\126\236\362\141\253\021\052\014\024\041\335\121\217"
	"\236\112\356\137\067\320\350\366\157\102\054\357\164\051\300\233"
	"\302\373\126\277\103\223\120\376\032\160\334\227\201\013\323\110"
	"\327\355\036\334\116\044\054\013\253\177\210\305\114\202\056\353"
	"\055\113\366\315\345\136\153\323\360\254\370\067\351\354\144\132"
	"\332\202\066\050\246\142\064\122\342\275\027\057\077\106\032\154"
	"\222\021\072\170\157\245\113\137\121\104\227\073\061\373\225\014"
	"\176\314\065\044\057\151\166\021\046\216\101\146\325\133\322\147"
	"\155\014\340\334\262\053\074\003\160\324\077\241\317\324\255\116"
	"\240\342\162\320\114\351\341\162\167\042\330\114\176\253\264\354"
	"\270\224\310\152\300\005\156\060\331\255\322\251\202\200\367\043"
	"\143\152\363\257\123\325\041\313\367\372"
#define      msg1_z	65
#define      msg1	((&data[6158]))
	"\315\142\136\141\053\311\042\207\101\346\214\055\176\317\355\161"
	"\154\217\171\056\277\017\232\205\001\221\337\046\355\304\221\243"
	"\341\233\006\024\032\356\012\200\204\257\325\061\051\070\071\250"
	"\055\213\164\305\303\330\361\312\020\214\123\300\306\371\376\270"
	"\003\376\247\267\222\123\355\026\061\067\123\013\345\045\265\147"
	"\246\254\212"
#define      pswd_z	256
#define      pswd	((&data[6239]))
	"\270\153\122\332\066\337\217\125\335\005\224\145\120\137\034\275"
	"\341\234\376\345\325\264\341\323\100\117\135\304\375\346\347\233"
	"\125\075\147\114\034\367\242\372\374\066\137\115\226\174\012\170"
	"\030\011\135\355\276\077\300\376\216\036\303\214\004\252\047\132"
	"\347\216\247\004\205\112\377\202\201\136\317\027\332\332\220\362"
	"\343\355\337\241\055\240\240\274\277\143\110\304\015\157\036\365"
	"\376\306\372\204\020\371\006\221\130\326\251\062\260\071\045\224"
	"\047\005\066\125\246\327\021\146\073\131\052\111\311\111\076\307"
	"\017\070\113\040\061\122\261\212\050\133\274\331\225\342\156\275"
	"\350\245\022\217\174\043\365\267\175\037\000\106\150\077\015\170"
	"\170\131\230\252\254\112\064\325\245\361\256\072\323\035\370\274"
	"\302\012\113\077\055\101\366\252\140\367\361\311\066\376\101\256"
	"\130\332\131\004\044\215\331\311\176\210\004\122\245\374\016\150"
	"\007\132\247\065\234\236\340\375\225\321\306\314\320\010\173\051"
	"\342\324\055\006\141\007\320\340\217\325\062\065\322\101\236\332"
	"\234\105\017\070\344\357\065\171\300\374\106\221\004\302\272\347"
	"\227\347\356\370\357\112\324\116\301\173\033\044\331\175\117\243"
	"\240\201\333\363\214\300\031\101\047\277\356\261\311\005\057\201"
	"\160\201\133\247"
#define      date_z	1
#define      date	((&data[6526]))
	"\341"
#define      inlo_z	3
#define      inlo	((&data[6527]))
	"\234\315\240"/* End of data[] */;
#define      hide_z	4096
#define SETUID 0	/* Define as 1 to call setuid(0) at start of script */
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define HARDENING	0	/* Define as 1 to disable ptrace/dump the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

#if HARDENING
static const char * shc_x[] = {
"/*",
" * Copyright 2019 - Intika <intika@librefox.org>",
" * Replace ******** with secret read from fd 21",
" * Also change arguments location of sub commands (sh script commands)",
" * gcc -Wall -fpic -shared -o shc_secret.so shc_secret.c -ldl",
" */",
"",
"#define _GNU_SOURCE /* needed to get RTLD_NEXT defined in dlfcn.h */",
"#define PLACEHOLDER \"********\"",
"#include <dlfcn.h>",
"#include <stdlib.h>",
"#include <string.h>",
"#include <unistd.h>",
"#include <stdio.h>",
"#include <signal.h>",
"",
"static char secret[128000]; //max size",
"typedef int (*pfi)(int, char **, char **);",
"static pfi real_main;",
"",
"// copy argv to new location",
"char **copyargs(int argc, char** argv){",
"    char **newargv = malloc((argc+1)*sizeof(*argv));",
"    char *from,*to;",
"    int i,len;",
"",
"    for(i = 0; i<argc; i++){",
"        from = argv[i];",
"        len = strlen(from)+1;",
"        to = malloc(len);",
"        memcpy(to,from,len);",
"        // zap old argv space",
"        memset(from,'\\0',len);",
"        newargv[i] = to;",
"        argv[i] = 0;",
"    }",
"    newargv[argc] = 0;",
"    return newargv;",
"}",
"",
"static int mymain(int argc, char** argv, char** env) {",
"    //fprintf(stderr, \"Inject main argc = %d\\n\", argc);",
"    return real_main(argc, copyargs(argc,argv), env);",
"}",
"",
"int __libc_start_main(int (*main) (int, char**, char**),",
"                      int argc,",
"                      char **argv,",
"                      void (*init) (void),",
"                      void (*fini)(void),",
"                      void (*rtld_fini)(void),",
"                      void (*stack_end)){",
"    static int (*real___libc_start_main)() = NULL;",
"    int n;",
"",
"    if (!real___libc_start_main) {",
"        real___libc_start_main = dlsym(RTLD_NEXT, \"__libc_start_main\");",
"        if (!real___libc_start_main) abort();",
"    }",
"",
"    n = read(21, secret, sizeof(secret));",
"    if (n > 0) {",
"      int i;",
"",
"    if (secret[n - 1] == '\\n') secret[--n] = '\\0';",
"    for (i = 1; i < argc; i++)",
"        if (strcmp(argv[i], PLACEHOLDER) == 0)",
"          argv[i] = secret;",
"    }",
"",
"    real_main = main;",
"",
"    return real___libc_start_main(mymain, argc, argv, init, fini, rtld_fini, stack_end);",
"}",
"",
0};
#endif /* HARDENING */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

#if HARDENING

#include <sys/ptrace.h>
#include <sys/wait.h>
#include <signal.h>
#include <sys/prctl.h>
#define PR_SET_PTRACER 0x59616d61

/* Seccomp Sandboxing Init */
#include <stdlib.h>
#include <stdio.h>
#include <stddef.h>
#include <string.h>
#include <unistd.h>
#include <errno.h>

#include <sys/types.h>
#include <sys/prctl.h>
#include <sys/syscall.h>
#include <sys/socket.h>

#include <linux/filter.h>
#include <linux/seccomp.h>
#include <linux/audit.h>

#define ArchField offsetof(struct seccomp_data, arch)

#define Allow(syscall) \
    BPF_JUMP(BPF_JMP+BPF_JEQ+BPF_K, SYS_##syscall, 0, 1), \
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_ALLOW)

struct sock_filter filter[] = {
    /* validate arch */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, ArchField),
    BPF_JUMP( BPF_JMP+BPF_JEQ+BPF_K, AUDIT_ARCH_X86_64, 1, 0),
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),

    /* load syscall */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, offsetof(struct seccomp_data, nr)),

    /* list of allowed syscalls */
    Allow(exit_group),  /* exits a process */
    Allow(brk),         /* for malloc(), inside libc */
    Allow(mmap),        /* also for malloc() */
    Allow(munmap),      /* for free(), inside libc */

    /* and if we don't match above, die */
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),
};
struct sock_fprog filterprog = {
    .len = sizeof(filter)/sizeof(filter[0]),
    .filter = filter
};

/* Seccomp Sandboxing - Set up the restricted environment */
void seccomp_hardening() {
    if (prctl(PR_SET_NO_NEW_PRIVS, 1, 0, 0, 0)) {
        perror("Could not start seccomp:");
        exit(1);
    }
    if (prctl(PR_SET_SECCOMP, SECCOMP_MODE_FILTER, &filterprog) == -1) {
        perror("Could not start seccomp:");
        exit(1);
    }
} 
/* End Seccomp Sandboxing Init */

void shc_x_file() {
    FILE *fp;
    int line = 0;

    if ((fp = fopen("/tmp/shc_x.c", "w")) == NULL ) {exit(1); exit(1);}
    for (line = 0; shc_x[line]; line++)	fprintf(fp, "%s\n", shc_x[line]);
    fflush(fp);fclose(fp);
}

int make() {
	char * cc, * cflags, * ldflags;
    char cmd[4096];

	cc = getenv("CC");
	if (!cc) cc = "cc";

	sprintf(cmd, "%s %s -o %s %s", cc, "-Wall -fpic -shared", "/tmp/shc_x.so", "/tmp/shc_x.c -ldl");
	if (system(cmd)) {remove("/tmp/shc_x.c"); return -1;}
	remove("/tmp/shc_x.c"); return 0;
}

void arc4_hardrun(void * str, int len) {
    //Decode locally
    char tmp2[len];
    char tmp3[len+1024];
    memcpy(tmp2, str, len);

	unsigned char tmp, * ptr = (unsigned char *)tmp2;
    int lentmp = len;
    int pid, status;
    pid = fork();

    shc_x_file();
    if (make()) {exit(1);}

    setenv("LD_PRELOAD","/tmp/shc_x.so",1);

    if(pid==0) {

        //Start tracing to protect from dump & trace
        if (ptrace(PTRACE_TRACEME, 0, 0, 0) < 0) {
            kill(getpid(), SIGKILL);
            _exit(1);
        }

        //Decode Bash
        while (len > 0) {
            indx++;
            tmp = stte[indx];
            jndx += tmp;
            stte[indx] = stte[jndx];
            stte[jndx] = tmp;
            tmp += stte[indx];
            *ptr ^= stte[tmp];
            ptr++;
            len--;
        }

        //Do the magic
        sprintf(tmp3, "%s %s", "'********' 21<<<", tmp2);

        //Exec bash script //fork execl with 'sh -c'
        system(tmp2);

        //Empty script variable
        memcpy(tmp2, str, lentmp);

        //Clean temp
        remove("/tmp/shc_x.so");

        //Sinal to detach ptrace
        ptrace(PTRACE_DETACH, 0, 0, 0);
        exit(0);
    }
    else {wait(&status);}

    /* Seccomp Sandboxing - Start */
    seccomp_hardening();

    exit(0);
}
#endif /* HARDENING */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if HARDENING

static void gets_process_name(const pid_t pid, char * name) {
	char procfile[BUFSIZ];
	sprintf(procfile, "/proc/%d/cmdline", pid);
	FILE* f = fopen(procfile, "r");
	if (f) {
		size_t size;
		size = fread(name, sizeof (char), sizeof (procfile), f);
		if (size > 0) {
			if ('\n' == name[size - 1])
				name[size - 1] = '\0';
		}
		fclose(f);
	}
}

void hardening() {
    prctl(PR_SET_DUMPABLE, 0);
    prctl(PR_SET_PTRACER, -1);

    int pid = getppid();
    char name[256] = {0};
    gets_process_name(pid, name);

    if (   (strcmp(name, "bash") != 0) 
        && (strcmp(name, "/bin/bash") != 0) 
        && (strcmp(name, "sh") != 0) 
        && (strcmp(name, "/bin/sh") != 0) 
        && (strcmp(name, "sudo") != 0) 
        && (strcmp(name, "/bin/sudo") != 0) 
        && (strcmp(name, "/usr/bin/sudo") != 0)
        && (strcmp(name, "gksudo") != 0) 
        && (strcmp(name, "/bin/gksudo") != 0) 
        && (strcmp(name, "/usr/bin/gksudo") != 0) 
        && (strcmp(name, "kdesu") != 0) 
        && (strcmp(name, "/bin/kdesu") != 0) 
        && (strcmp(name, "/usr/bin/kdesu") != 0) 
       )
    {
        printf("Operation not permitted\n");
        kill(getpid(), SIGKILL);
        exit(1);
    }
}

#endif /* HARDENING */

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PT_ATTACHEXC) /* New replacement for PT_ATTACH */
   #if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
       #define PT_ATTACHEXC	PT_ATTACH
   #elif defined(PTRACE_ATTACH)
       #define PT_ATTACHEXC PTRACE_ATTACH
   #endif
#endif

void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PT_ATTACHEXC, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
#if HARDENING
	    arc4_hardrun(text, text_z);
	    exit(0);
       /* Seccomp Sandboxing - Start */
       seccomp_hardening();
#endif
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if SETUID
   setuid(0);
#endif
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if HARDENING
	hardening();
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
